# ğŸ“Š PostHog Dashboards - AXSOL Viewer (CORREGIDO)

**GuÃ­a corregida basada en eventos âœ… IMPLEMENTADOS Ãºnicamente**

**Eventos base:** Solo eventos activos del `0.ANALYTICS_EVENTS_CATALOG.md`

---

## âœ… **Eventos Implementados Disponibles**

**Para Dashboards podemos usar:**
- âœ… `user_signed_up` - Registros
- âœ… `user_logged_in` - Inicios de sesiÃ³n
- âœ… `viewer_loaded` - Carga del visor 3D
- âœ… `viewer_load_failed` - Errores de carga
- âœ… `entity_clicked` - Clicks en entidades 3D
- âœ… `camera_moved` - NavegaciÃ³n (con coordenadas)
- âœ… `camera_zoomed` - Zoom especÃ­fico
- âœ… `camera_session_ended` - Fin de sesiÃ³n navegaciÃ³n
- âœ… `home_view_activated` - Click botÃ³n Home
- âœ… `timeline_playback_control` - Control timeline
- âœ… `timeline_play_session` - Sesiones de reproducciÃ³n
- âœ… `timeline_speed_changed` - Cambios de velocidad
- âœ… `timeline_date_jumped` - Saltos de fecha
- âœ… `timeline_loop_toggled` - Toggle bucle
- âœ… `layer_toggled` - ActivaciÃ³n de capas
- âœ… `capture_date_changed` - Cambio fecha captura
- âœ… `media_lightbox_opened` - Apertura lightbox

---

## ğŸ¯ Dashboards Implementables

### **1. Viewer Performance Dashboard** âœ…
### **2. User Navigation Dashboard** âœ…
### **3. Feature Adoption Dashboard** âœ…
### **4. User Engagement Dashboard** âœ…

---

## ğŸ“‹ Dashboard 1: Viewer Performance âœ…

**Objetivo:** Monitorear performance del visor con eventos reales.

### **A. Viewer Load Success Rate**

**MÃ©trica:** Tasa de Ã©xito de carga del viewer

**CÃ³mo crear:**
1. PostHog â†’ Dashboards â†’ New Dashboard: "Viewer Performance"
2. Add Insight â†’ Trends
3. Configurar:
   - Series A: `viewer_loaded` (count) âœ…
   - Series B: `viewer_load_failed` (count) âœ…
   - Formula: `A / (A + B) * 100`
   - Graph type: Line chart
   - Date range: Last 30 days

**Alertas:**
- âš ï¸ Success rate < 95%
- ğŸš¨ Success rate < 90%

---

### **B. Daily Viewer Loads**

**MÃ©trica:** Volumen de cargas del viewer por dÃ­a

**CÃ³mo crear:**
1. Add Insight â†’ Trends
2. Configurar:
   - Event: `viewer_loaded` âœ…
   - Aggregation: Total count
   - Breakdown: `project_id`
   - Graph type: Bar chart
   - Date range: Last 7 days

**Insights:**
- Proyectos mÃ¡s utilizados
- Patrones de uso por dÃ­a

---

### **C. Error Tracking**

**MÃ©trica:** Errores de carga del viewer

**CÃ³mo crear:**
1. Add Insight â†’ Trends
2. Configurar:
   - Event: `viewer_load_failed` âœ…
   - Aggregation: Total count
   - Breakdown: `error` (si disponible)
   - Graph type: Table
   - Date range: Last 7 days

**Alertas:**
- ğŸš¨ MÃ¡s de 5 errores por hora

---

## ğŸ“‹ Dashboard 2: User Navigation âœ…

**Objetivo:** Entender patrones de navegaciÃ³n reales.

### **A. Camera Movement Heatmap Data**

**MÃ©trica:** Coordenadas mÃ¡s visitadas

**CÃ³mo crear:**
1. Add Insight â†’ Custom SQL
2. Query:
```sql
SELECT 
  ROUND(CAST(properties->>'latitude' AS NUMERIC), 3) as lat,
  ROUND(CAST(properties->>'longitude' AS NUMERIC), 3) as lon,
  COUNT(*) as visits,
  properties->>'project_id' as project_id
FROM events
WHERE event = 'camera_moved'
  AND timestamp > NOW() - INTERVAL '7 days'
  AND properties->>'latitude' IS NOT NULL
GROUP BY lat, lon, project_id
HAVING COUNT(*) > 3
ORDER BY visits DESC
LIMIT 200
```

**ExportaciÃ³n para heatmap:**
- Exportar CSV para usar en Kepler.gl o Mapbox
- Formato: latitude, longitude, weight, project_id

---

### **B. Navigation Session Duration**

**MÃ©trica:** DuraciÃ³n de sesiones de navegaciÃ³n

**CÃ³mo crear:**
1. Add Insight â†’ Trends
2. Configurar:
   - Event: `camera_session_ended` âœ…
   - Property: `session_duration_s`
   - Aggregation: Average
   - Breakdown: `project_id`
   - Graph type: Bar chart
   - Date range: Last 30 days

**Insights:**
- Proyectos mÃ¡s "adictivos"
- Engagement por proyecto

---

### **C. Movement Type Distribution**

**MÃ©trica:** Tipos de movimientos de cÃ¡mara

**CÃ³mo crear:**
1. Add Insight â†’ Trends
2. Configurar:
   - Event: `camera_moved` âœ…
   - Aggregation: Total count
   - Breakdown: `movement_type` (zoom, pan, rotate, tilt, adjust)
   - Visualization: Pie chart
   - Date range: Last 7 days

**Insights esperados:**
- Zoom: ~40%
- Pan: ~30%
- Rotate: ~20%
- Tilt: ~10%

---

### **D. Home Button Usage**

**MÃ©trica:** Frecuencia de uso del botÃ³n Home

**CÃ³mo crear:**
1. Add Insight â†’ Trends
2. Configurar:
   - Event: `home_view_activated` âœ…
   - Aggregation: Total count
   - Breakdown: `trigger` (button, shortcut)
   - Date range: Last 30 days

**Insights:**
- Â¿Los usuarios se pierden navegando?
- Efectividad del botÃ³n Home

---

## ğŸ“‹ Dashboard 3: Feature Adoption âœ…

**Objetivo:** Medir adopciÃ³n de features implementadas.

### **A. Timeline Adoption Funnel**

**MÃ©trica:** Funnel de adopciÃ³n del timeline

**CÃ³mo crear:**
1. Add Insight â†’ Funnel
2. Steps:
   - Step 1: `viewer_loaded` âœ…
   - Step 2: `timeline_playback_control` âœ…
   - Step 3: `timeline_play_session` âœ…
   - Step 4: `timeline_speed_changed` âœ…

**Insights:**
- % usuarios que descubren timeline
- % que realmente lo usan
- % que ajustan velocidad (power users)

---

### **B. Layer Usage Metrics**

**MÃ©trica:** AdopciÃ³n de capas

**Dashboard cards:**

#### **1. Layer Activation Rate**
```
Event: layer_toggled âœ…
Series A: Unique users who toggled layers
Series B: Unique users who loaded viewer
Formula: (A / B) * 100
Display: "X% activated layers"
```

#### **2. Layer Type Distribution**
```
Event: layer_toggled âœ…
Breakdown: layer_type (realidad3D, fotos, fotos360, plan, ifc)
Visualization: Bar chart
Filter: enabled = true
```

#### **3. Date Change Frequency**
```
Event: capture_date_changed âœ…
Aggregation: Total count
Breakdown: layer_type
Date range: Last 30 days
```

---

### **C. Media Engagement**

**MÃ©trica:** Uso del lightbox de fotos

**CÃ³mo crear:**
1. Add Insight â†’ Trends
2. Configurar:
   - Event: `media_lightbox_opened` âœ…
   - Aggregation: Total count
   - Breakdown: `media_type` (photo, photo360)
   - Date range: Last 30 days

**Insights:**
- Engagement con contenido visual
- Preferencia por fotos vs 360Â°

---

### **D. Entity Interaction Rate**

**MÃ©trica:** InteracciÃ³n con elementos 3D

**CÃ³mo crear:**
1. Add Insight â†’ Trends
2. Configurar:
   - Event: `entity_clicked` âœ…
   - Aggregation: Total count
   - Breakdown: `entity_type` (photo, photo360, plan, ifc)
   - Date range: Last 30 days

**Insights:**
- Elementos mÃ¡s clickeados
- Engagement con modelo 3D

---

## ğŸ“‹ Dashboard 4: User Engagement âœ…

**Objetivo:** Medir engagement general con eventos reales.

### **A. Daily Active Users (DAU)**

**CÃ³mo crear:**
1. Add Insight â†’ Trends
2. Configurar:
   - Event: `user_logged_in` âœ…
   - Aggregation: Unique users
   - Date range: Last 30 days
   - Graph type: Line chart

**Variantes:**
- WAU (Weekly Active Users)
- MAU (Monthly Active Users)

---

### **B. Viewer Engagement Rate**

**MÃ©trica:** % de usuarios que usan el viewer despuÃ©s de login

**CÃ³mo crear:**
1. Add Insight â†’ Trends
2. Configurar:
   - Series A: `viewer_loaded` â†’ Unique users âœ…
   - Series B: `user_logged_in` â†’ Unique users âœ…
   - Formula: `(A / B) * 100`
   - Date range: Last 30 days

**Target:** >80% de usuarios que hacen login abren el viewer

---

### **C. Feature Usage Matrix (Implementado)**

**MÃ©trica:** % de usuarios que usan cada feature disponible

#### **1. Timeline Usage Rate**
```
Series A: timeline_playback_control â†’ Unique users âœ…
Series B: viewer_loaded â†’ Unique users âœ…
Formula: (A / B) * 100
Display: "X% used Timeline"
```

#### **2. Layer Usage Rate**
```
Series A: layer_toggled â†’ Unique users âœ…
Series B: viewer_loaded â†’ Unique users âœ…
Formula: (A / B) * 100
Display: "X% toggled Layers"
```

#### **3. Navigation Rate**
```
Series A: camera_moved â†’ Unique users âœ…
Series B: viewer_loaded â†’ Unique users âœ…
Formula: (A / B) * 100
Display: "X% navigated actively"
```

#### **4. Media Viewing Rate**
```
Series A: media_lightbox_opened â†’ Unique users âœ…
Series B: viewer_loaded â†’ Unique users âœ…
Formula: (A / B) * 100
Display: "X% viewed media"
```

---

### **D. Session Quality Metrics**

**MÃ©trica:** Calidad de las sesiones de usuario

#### **1. Average Navigation Session Duration**
```
Event: camera_session_ended âœ…
Property: session_duration_s
Aggregation: Average
Breakdown: project_id
```

#### **2. Actions Per Viewer Session**
```sql
SELECT 
  DATE(timestamp) as date,
  COUNT(*) / COUNT(DISTINCT session_id) as avg_actions_per_session
FROM events
WHERE event IN ('camera_moved', 'entity_clicked', 'layer_toggled', 'timeline_playback_control')
  AND timestamp > NOW() - INTERVAL '30 days'
GROUP BY date
ORDER BY date
```

---

## ğŸ¨ Dashboard Layout Implementable

### **Main Dashboard: Executive View**

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  AXSOL Viewer - Overview Dashboard                  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ DAU          â”‚ Viewer       â”‚ Success Rate         â”‚
â”‚ (logged in)  â”‚ Engagement   â”‚ (load success)       â”‚
â”‚ 1,234        â”‚ 85%          â”‚ 97.2%                â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                      â”‚
â”‚  Daily Active Users (Last 30 days)                  â”‚
â”‚  [Line chart: user_logged_in unique users]         â”‚
â”‚                                                      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  Feature Adoption (Implemented)                    â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”            â”‚
â”‚  â”‚ Timeline:  45% â”‚â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â”‚   â”‚            â”‚
â”‚  â”‚ Layers:    78% â”‚â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â”‚   â”‚            â”‚
â”‚  â”‚ Navigation:92% â”‚â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ”‚   â”‚            â”‚
â”‚  â”‚ Media:     34% â”‚â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â”‚   â”‚            â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜            â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  Top Projects by Engagement                         â”‚
â”‚  [Table: Project | Viewer Loads | Avg Nav Duration] â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ”” Alertas Implementables

### **Performance Alerts**

```yaml
Alert 1: Viewer Load Failures
  Condition: viewer_load_failed count > 5 in last hour
  Severity: High
  Notify: Slack #tech-alerts

Alert 2: Low Viewer Engagement
  Condition: viewer_loaded unique users < 80% of user_logged_in
  Severity: Medium
  Notify: Email to product team

Alert 3: No Data
  Condition: No viewer_loaded events in last 2 hours
  Severity: High
  Notify: Slack + PagerDuty
```

### **Business Alerts**

```yaml
Alert 4: Low DAU
  Condition: user_logged_in unique users drops > 20% day-over-day
  Severity: Medium
  Notify: Slack #product

Alert 5: Feature Adoption Drop
  Condition: timeline_playback_control usage drops > 30% week-over-week
  Severity: Low
  Notify: Email to product team
```

---

## ğŸ¯ KPIs Implementables

| KPI | Event Base | Target | Status |
|-----|------------|--------|--------|
| DAU | `user_logged_in` unique | 500 | ğŸŸ¡ |
| Viewer Engagement | `viewer_loaded` / `user_logged_in` | >80% | ğŸŸ¡ |
| Load Success Rate | `viewer_loaded` / (`viewer_loaded` + `viewer_load_failed`) | >95% | ğŸŸ¡ |
| Timeline Adoption | `timeline_playback_control` / `viewer_loaded` | >40% | ğŸŸ¡ |
| Layer Adoption | `layer_toggled` / `viewer_loaded` | >60% | ğŸŸ¡ |
| Avg Navigation Session | `camera_session_ended.session_duration_s` avg | >5 min | ğŸŸ¡ |

---

## ğŸš¨ **Eventos NO Disponibles para Dashboards**

âŒ **NO usar estos eventos** (pendientes):
- `photo360_viewer` â†’ Usar `media_lightbox_opened` con `media_type: 'photo360'`
- `model_inspected` â†’ No existe
- `viewer_error` â†’ Usar `viewer_load_failed`
- `measurement_created` â†’ Pendiente
- `dashboard_viewed` â†’ Pendiente
- `project_clicked` â†’ Pendiente

---

## ğŸš€ PrÃ³ximos Pasos IMPLEMENTABLES

1. âœ… **Crear Dashboard 1: Viewer Performance** (30 min)
2. âœ… **Crear Dashboard 2: User Navigation** (45 min)
3. âœ… **Crear Dashboard 3: Feature Adoption** (45 min)
4. âœ… **Crear Dashboard 4: User Engagement** (30 min)
5. âœ… **Configurar alertas crÃ­ticas** (15 min)
6. âœ… **Setup weekly reports** (10 min)

**Total tiempo estimado:** ~3 horas

---

## ğŸ“š Queries SQL Ãštiles

### **Query 1: Navigation Heatmap Data**
```sql
SELECT 
  properties->>'project_id' as project,
  ROUND(CAST(properties->>'latitude' AS NUMERIC), 3) as lat,
  ROUND(CAST(properties->>'longitude' AS NUMERIC), 3) as lon,
  COUNT(*) as visits
FROM events
WHERE event = 'camera_moved'
  AND timestamp > NOW() - INTERVAL '7 days'
GROUP BY project, lat, lon
HAVING COUNT(*) > 2
ORDER BY visits DESC
```

### **Query 2: Feature Adoption Summary**
```sql
SELECT 
  'Timeline' as feature,
  COUNT(DISTINCT person_id) as users
FROM events
WHERE event = 'timeline_playback_control'
  AND timestamp > NOW() - INTERVAL '30 days'

UNION ALL

SELECT 
  'Layers' as feature,
  COUNT(DISTINCT person_id) as users
FROM events
WHERE event = 'layer_toggled'
  AND timestamp > NOW() - INTERVAL '30 days'

UNION ALL

SELECT 
  'Navigation' as feature,
  COUNT(DISTINCT person_id) as users
FROM events
WHERE event = 'camera_moved'
  AND timestamp > NOW() - INTERVAL '30 days'
```

### **Query 3: Daily Engagement Metrics**
```sql
SELECT 
  DATE(timestamp) as date,
  COUNT(DISTINCT CASE WHEN event = 'user_logged_in' THEN person_id END) as dau,
  COUNT(DISTINCT CASE WHEN event = 'viewer_loaded' THEN person_id END) as viewer_users,
  COUNT(DISTINCT CASE WHEN event = 'timeline_playback_control' THEN person_id END) as timeline_users
FROM events
WHERE timestamp > NOW() - INTERVAL '30 days'
GROUP BY date
ORDER BY date
```

---

**ğŸ“Š Estado:** âœ… **IMPLEMENTABLE** - Solo eventos activos y funcionales
